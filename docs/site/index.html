<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="None">
        
        
        <link rel="shortcut icon" href="img/favicon.ico">
        <title>Python-Webex-Bot</title>
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <link href="css/font-awesome.min.css" rel="stylesheet">
        <link href="css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

        <script src="js/jquery-1.10.2.min.js" defer></script>
        <script src="js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body class="homepage">
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href=".">Python-Webex-Bot</a>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#python_webex_bot" class="nav-link">python_webex_bot</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#installation-and-setup" class="nav-link">Installation and setup</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#quickstart" class="nav-link">Quickstart</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="python_webex_bot">python_webex_bot</h1>
<p>A python3 library meant to help you create a cisco webex teams bot and take advantage of some of the features available to these bots. 
Most of the python libraries setup for webex have been lacking in terms of connecting you to a webhook and this aims at solving that</p>
<h2 id="installation-and-setup">Installation and setup</h2>
<p>The following are items this documentation assumes you already have installed: 
 - virtualenv
 - python3
 - <a href="https://ngrok.com/download">ngrok</a></p>
<h3 id="step-1-setup-the-virtual-environment">Step 1: setup the virtual environment</h3>
<p>to initialize the virtual environment, run the following command in your Command Line or Command Prompt</p>
<pre><code>virtualenv venv
</code></pre>

<p>then we activate it:</p>
<p><i>Windows</i></p>
<pre><code>venv\Scripts\activate
</code></pre>

<p><i>Linux</i></p>
<pre><code>source venv/bin/activate
</code></pre>

<p>and there, you have your virtual environment setup and ready for action</p>
<h3 id="step-2-install-python_webex_bot">Step 2: install python_webex_bot</h3>
<p>while still in your activated virtual environment, run the following command to install python_webex_bot via pip:</p>
<pre><code>pip install python_webex_bot
</code></pre>

<p>then download <a href="https://ngrok.com/download">ngrok</a> which will be used in the concurrent steps</p>
<h2 id="quickstart">Quickstart</h2>
<p>Lets get a simple bot up, running and responsive on our local machine. </p>
<h3 id="step-1-create-the-bot-on-cisco-webex">Step 1: Create the bot on Cisco Webex</h3>
<p>If you haven't already, <a href="https://teams.webex.com/signin">create your Webex account.</a> 
Then head on to <a href="https://developer.webex.com/my-apps/new/bot">create your bot</a></p>
<p>You should be provided with an <u>access token </u> for the bot.</p>
<p>Take this access token and place it in your environment variable as auth_token.</p>
<p>this can be done via your Command prompt or Command Line as:</p>
<pre><code>export auth_token=my_auth_token
</code></pre>

<p>If you're on <i>Windows</i>, run the following on the command prompt:</p>
<pre><code>set auth_token=my_auth_token
</code></pre>

<p>replace my_auth_token with your bots access token</p>
<p><b>This is a crutial part of running your bot as the python_webex_bot library uses this to identify your bot</b></p>
<p>If you still have some questions on environment variables, why we need them and how to use them, <a href="https://medium.com/chingu/an-introduction-to-environment-variables-and-how-to-use-them-f602f66d15fa">this</a> may be a good start</p>
<h3 id="step-2-setup-ngrok">Step 2: setup ngrok</h3>
<p>in a different terminal from the one used in steps 1 and 2, navigate to the folder where you have the ngrok placed. </p>
<p>Then run the following command:</p>
<pre><code>ngrok http 5000
</code></pre>

<p>This should produce an output similar to the one shown below:</p>
<pre><code>Session Status                online
Session Expires               7 hours, 59 minutes
Update                        update available (version 2.3.25, Ctrl-U to update)
Version                       2.3.18
Region                        United States (us)
Web Interface                 http://127.0.0.1:4040
Forwarding                    http://87a942a1.ngrok.io -&gt; http://localhost:5000
Forwarding                    https://87a942a1.ngrok.io -&gt; http://localhost:5000

Connections                   ttl     opn     rt1     rt5     p50     p90
                              0       0       0.00    0.00    0.00    0.00
</code></pre>

<p><i>Now you are ready for the quest</i></p>
<h3 id="step-3-create-the-python-file-and-run-it">Step 3: create the python file and run it</h3>
<p>Create a python file where you intend to run the bot. In my case, I will name my file <code>run.py</code></p>
<p>copy and paste the following code:</p>
<pre><code>from python_webex.v1.Bot import Bot
from python_webex import webhook

bot = Bot()         # the program will automatically know the bot being referred to y the auth_token

# create a webhook to expose it to the internet
# rememer that url we got from step 2, this is where we use it. In my case it was http://87a942a1.ngrok.io. 
# We will be creating a webhook that will be listening when messages are sent
bot.create_webhook(
    name=&quot;quickstart_webhook&quot;, target_url=&quot;http://87a942a1.ngrok.io&quot;, resource=&quot;messages&quot;, event=&quot;created&quot;
)

# we create a function that responds when someone says hi
# the room_id will automatically be filled with the webhook. Do not forget it
@bot.on_hears(&quot;hi)
def greet_back(room_id=None):
    return bot.send_message(room_id=room_id, text=&quot;Hi, how are you doing?&quot;)

# We create a default response in case anyone types anything else that we have not set a response for
# this is done using * [ don't ask me what happend when someone sends '*' as the message, that's on my TODO]
@bot.on_hears(&quot;*&quot;)
def default_response(room_id=None):
    return bot.send_message(room_id=room_id, text=&quot;Sorry, could not understand that&quot;)


# make the webhook know the bot to be listening for, and we are done
webhook.bot = bot

if __name__ == &quot;__main__&quot;:
    webhook.app.run(debug=True)         # don't keep debug=True in production
</code></pre>

<p>Now, when we text our bot "hi", it will respond with "Hi, how are you doing?"</p>
<p>And when we text anything else, like "When can we meet up?" it will respond with "Sorry, I could not understand that"</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = ".",
                shortcuts = {"next": 78, "help": 191, "search": 83, "previous": 80};
        </script>
        <script src="js/base.js" defer></script>
        <script src="search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>

<!--
MkDocs version : 1.1
Build Date UTC : 2020-02-27 07:17:28
-->
